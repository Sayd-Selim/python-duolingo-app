import React, { useState, useEffect, useCallback, useMemo } from "react";
import { motion } from "framer-motion";
import { Link, useNavigate } from "react-router-dom";
import { useLessonProgress } from "../../hooks/useLessonProgress";
import { useAuth } from "../../context/AuthContext";

function Level1Unit4() {
  const [showHint, setShowHint] = useState(false);
  const [showAnswer, setShowAnswer] = useState(false);
  const [userAnswer, setUserAnswer] = useState("");
  const [additionalTaskAnswers, setAdditionalTaskAnswers] = useState({});
  const [additionalTaskHints, setAdditionalTaskHints] = useState({});
  const [additionalTaskAttempts, setAdditionalTaskAttempts] = useState({});
  const [additionalTaskShowAnswer, setAdditionalTaskShowAnswer] = useState({});
  const [isCorrect, setIsCorrect] = useState(null);
  const [lessonCompleted, setLessonCompleted] = useState(false);
  const [showCongratulations, setShowCongratulations] = useState(false);
  const [isLessonPassed, setIsLessonPassed] = useState(false);
  const navigate = useNavigate();
  // –ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–ù–û: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  // const { user } = useAuth();

  // –°–æ–∑–¥–∞–µ–º —Ñ–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  const user = { userId: "demo_user_123" };

  // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å localStorage
  const saveLessonProgress = (lessonId) => {
    try {
      const completedLessons = JSON.parse(localStorage.getItem("completedLessons") || "[]");
      if (!completedLessons.includes(lessonId)) {
        completedLessons.push(lessonId);
        localStorage.setItem("completedLessons", JSON.stringify(completedLessons));
      }
      console.log("–£—Ä–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ localStorage:", lessonId);
    } catch (error) {
      console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage:", error);
    }
  };

  const checkLessonProgress = (lessonId) => {
    try {
      const completedLessons = JSON.parse(localStorage.getItem("completedLessons") || "[]");
      return completedLessons.includes(lessonId);
    } catch (error) {
      console.error("–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ localStorage:", error);
      return false;
    }
  };

  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—ã–π —Ö—É–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
  const { currentStep, lessonProgress, updateCurrentStep, saveStepAnswer, getStepAnswer, isLessonCompleted, completeLesson, clearLessonProgress } =
    useLessonProgress(2);

  // –û—Ç–ª–∞–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π isCorrect (–ø–µ—Ä–µ–º–µ—â–µ–Ω–æ –ø–æ—Å–ª–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è currentStep)
  useEffect(() => {
    console.log("=== isCorrect –ò–ó–ú–ï–ù–ò–õ–°–Ø ===");
    console.log("–ù–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ isCorrect:", isCorrect);
    console.log("–¢–µ–∫—É—â–∏–π —à–∞–≥:", currentStep);
    console.log("userAnswer:", userAnswer);
  }, [isCorrect, currentStep, userAnswer]);

  // –û—Ç–ª–∞–¥–∫–∞ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
  console.log("=== –ö–û–ú–ü–û–ù–ï–ù–¢ –ü–ï–†–ï–†–ï–ù–î–ï–†–ï–ù ===");
  console.log("currentStep:", currentStep);
  console.log("userAnswer:", userAnswer);
  console.log("isCorrect:", isCorrect);

  // –ú–µ–º–æ–∏–∑–∏—Ä—É–µ–º —à–∞–≥–∏ —É—Ä–æ–∫–∞
  const steps = useMemo(
    () => [
      {
        type: "intro",
        title: "–û–ø–µ—Ä–∞—Ç–æ—Ä—ã –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤ Python ‚ö°Ô∏è",
        content:
          "üéØ –í —ç—Ç–æ–º —É—Ä–æ–∫–µ —Ç—ã —É–∑–Ω–∞–µ—à—å, –∫–∞–∫ Python —Å—á–∏—Ç–∞–µ—Ç, —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è!\n\n–û–ø–µ—Ä–∞—Ç–æ—Ä—ã ‚Äî —ç—Ç–æ –∫–∞–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: —Å –∏—Ö –ø–æ–º–æ—â—å—é —Ç—ã —Å–∫–ª–∞–¥—ã–≤–∞–µ—à—å, —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—à—å, –ø—Ä–æ–≤–µ—Ä—è–µ—à—å —É—Å–ª–æ–≤–∏—è.\n\nüí° –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç–≤–æ–π –∫–æ–¥ ‚Äî —ç—Ç–æ –∫—É—Ö–Ω—è, –∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã ‚Äî –Ω–æ–∂–∏, –ª–æ–∂–∫–∏ –∏ –≤–µ–Ω—á–∏–∫–∏. –° –∏—Ö –ø–æ–º–æ—â—å—é —Ç—ã —Å–º–µ—à–∏–≤–∞–µ—à—å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã (–¥–∞–Ω–Ω—ã–µ) –∏ –ø–æ–ª—É—á–∞–µ—à—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–≤—ã—Ä–∞–∂–µ–Ω–∏–µ)!\n\n–°–µ–≥–æ–¥–Ω—è —Ä–∞–∑–±–µ—Ä—ë–º –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã.",
        code: `# –ü—Ä–∏–º–µ—Ä –≤—ã—Ä–∞–∂–µ–Ω–∏—è\na = 5 + 3  # 8\nb = 10 - 2  # 8\nc = a > b  # False`,
        motivation: "–û–ø–µ—Ä–∞—Ç–æ—Ä—ã ‚Äî —Ç–≤–æ–π –ø–µ—Ä–≤—ã–π —à–∞–≥ –∫ —Å–æ–∑–¥–∞–Ω–∏—é —É–º–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º! –ù–µ –±–æ–π—Å—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å ‚Äî –æ—à–∏–±–∫–∏ —ç—Ç–æ –æ–ø—ã—Ç!",
      },
      {
        type: "theory",
        title: "–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã ‚ûï‚ûñ‚úñÔ∏è‚ûó",
        content:
          "‚ûï –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å, –≤—ã—á–∏—Ç–∞—Ç—å, —É–º–Ω–æ–∂–∞—Ç—å, –¥–µ–ª–∏—Ç—å –∏ –¥–µ–ª–∞—Ç—å –µ—â—ë –º–Ω–æ–≥–æ –≤—Å–µ–≥–æ!\n\n–í Python –µ—Å—Ç—å —Ç–∞–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã:\n+  ‚Äî —Å–ª–æ–∂–µ–Ω–∏–µ\n-  ‚Äî –≤—ã—á–∏—Ç–∞–Ω–∏–µ\n*  ‚Äî —É–º–Ω–æ–∂–µ–Ω–∏–µ\n/  ‚Äî –¥–µ–ª–µ–Ω–∏–µ (–≤—Å–µ–≥–¥–∞ float)\n// ‚Äî —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ (–±–µ–∑ –æ—Å—Ç–∞—Ç–∫–∞)\n%  ‚Äî –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è\n** ‚Äî –≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç–µ–ø–µ–Ω—å\n\nüì¶ –ü—Ä–µ–¥—Å—Ç–∞–≤—å:\n+ ‚Äî —ç—Ç–æ —Å–æ–≤–º–µ—â–µ–Ω–∏–µ –¥–≤—É—Ö –∫–æ—Ä–æ–±–æ–∫,\n- ‚Äî —É–±–∏—Ä–∞–µ—à—å —á—Ç–æ-—Ç–æ –∏–∑ –∫–æ—Ä–æ–±–∫–∏,\n* ‚Äî –º–Ω–æ–∂–∏—à—å –∫–æ—Ä–æ–±–∫–∏,\n/ ‚Äî –¥–µ–ª–∏—à—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–µ–∂–¥—É –¥—Ä—É–∑—å—è–º–∏.\n\nüí∞ –í –º–∞–≥–∞–∑–∏–Ω–µ:\n+ ‚Äî —ç—Ç–æ —Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫,\n- ‚Äî —Å–¥–∞—á–∞,\n* ‚Äî —Ü–µ–Ω–∞ –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä–æ–≤,\n/ ‚Äî –¥–µ–ª–∏—à—å —Å—á—ë—Ç –º–µ–∂–¥—É –¥—Ä—É–∑—å—è–º–∏.\n\nüî¢ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å:",
        code: `a = 10\nb = 3\nsum = a + b      # 13\ndiff = a - b     # 7\nprod = a * b     # 30\ndiv = a / b      # 3.333...\nint_div = a // b # 3\nmod = a % b      # 1\npow = a ** b     # 1000`,
        explanation:
          "a –∏ b ‚Äî —ç—Ç–æ —á–∏—Å–ª–∞.\n\n+ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç,\n- –≤—ã—á–∏—Ç–∞–µ—Ç,\n* —É–º–Ω–æ–∂–∞–µ—Ç,\n/ –¥–µ–ª–∏—Ç (–≤—Å–µ–≥–¥–∞ —Å —Ç–æ—á–∫–æ–π!),\n// ‚Äî –¥–µ–ª–∏—Ç –±–µ–∑ –æ—Å—Ç–∞—Ç–∫–∞,\n% ‚Äî –¥–∞—ë—Ç –æ—Å—Ç–∞—Ç–æ–∫,\n** ‚Äî –≤–æ–∑–≤–æ–¥–∏—Ç –≤ —Å—Ç–µ–ø–µ–Ω—å.\n\nüçï –î–µ–ª–∏—Ç—å –ø–∏—Ü—Ü—É –º–µ–∂–¥—É –¥—Ä—É–∑—å—è–º–∏:\n7 // 3 = 2 (–∫–∞–∂–¥–æ–º—É –ø–æ 2 –∫—É—Å–∫–∞),\n7 % 3 = 1 (–æ—Å—Ç–∞–Ω–µ—Ç—Å—è 1 –∫—É—Å–æ–∫).",
        examples: [
          // +
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä + (—Å–ª–æ–∂–µ–Ω–∏–µ)?:",
          "–í –∏–≥—Ä–µ: —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ—á–∫–æ–≤: score = score + 10",
          "–í –º–∞–≥–∞–∑–∏–Ω–µ: —Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫: total = price1 + price2",
          "–í –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–µ: print(2 + 3)",
          // -
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä - (–≤—ã—á–∏—Ç–∞–Ω–∏–µ)?:",
          "–í –º–∞–≥–∞–∑–∏–Ω–µ: —Å–¥–∞—á–∞: change = paid - price",
          "–í —Å–ø–æ—Ä—Ç–µ: —Ä–∞–∑–Ω–∏—Ü–∞ –æ—á–∫–æ–≤: diff = team1 - team2",
          // *
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä * (—É–º–Ω–æ–∂–µ–Ω–∏–µ)?:",
          "–í –º–∞–≥–∞–∑–∏–Ω–µ: —Ü–µ–Ω–∞ –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä–æ–≤: total = price * count",
          "–í –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ: –ø–ª–æ—â–∞–¥—å –∫–≤–∞–¥—Ä–∞—Ç–∞: area = side * side",
          // /
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä / (–¥–µ–ª–µ–Ω–∏–µ)?:",
          "–í –∫—É–ª–∏–Ω–∞—Ä–∏–∏: –¥–µ–ª–∏–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã: portion = total / people",
          "–í —Ñ–∏–Ω–∞–Ω—Å–∞—Ö: —Å—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥: avg = total / months",
          // //
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä // (—Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ)?:",
          "–í –∏–≥—Ä–∞—Ö: —Å–∫–æ–ª—å–∫–æ –ø–æ–ª–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π: levels = exp // 100",
          "–í –±—ã—Ç—É: —Å–∫–æ–ª—å–∫–æ –ø–æ–ª–Ω—ã—Ö –∫–æ—Ä–æ–±–æ–∫: boxes = apples // 6",
          // %
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä % (–æ—Å—Ç–∞—Ç–æ–∫)?:",
          "–ü—Ä–æ–≤–µ—Ä–∫–∞ —á—ë—Ç–Ω–æ—Å—Ç–∏: if x % 2 == 0: print('–ß—ë—Ç–Ω–æ–µ')",
          "–í –∏–≥—Ä–∞—Ö: —Ö–æ–¥ –∏–≥—Ä–æ–∫–∞: if turn % 2 == 0: ...",
          // **
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä ** (—Å—Ç–µ–ø–µ–Ω—å)?:",
          "–í –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ: –≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ –∫–≤–∞–¥—Ä–∞—Ç: sq = x ** 2",
          "–í —Ñ–∏–Ω–∞–Ω—Å–∞—Ö: —Å–ª–æ–∂–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç: total = deposit * (1.05 ** years)",
          // –û—à–∏–±–∫–∏
          "‚ö†Ô∏è –û—à–∏–±–∫–∞: –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å!",
          "a = 5\nb = 0\nprint(a / b)  # –û—à–∏–±–∫–∞! –ù–µ–ª—å–∑—è –¥–µ–ª–∏—Ç—å –Ω–∞ –Ω–æ–ª—å.",
          "‚úÖ –†–µ—à–µ–Ω–∏–µ: –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å!",
          "if b != 0: print(a / b)",
          "–†–µ–∑—é–º–∏—Ä—É—è:",
          "–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã ‚Äî —Ç–≤–æ–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤ Python! –ë–µ–∑ –Ω–∏—Ö –Ω–µ –±—É–¥–µ—Ç –Ω–∏ –∏–≥—Ä, –Ω–∏ –º–∞–≥–∞–∑–∏–Ω–æ–≤, –Ω–∏ —Ä–∞—Å—á—ë—Ç–æ–≤!",
        ],
        motivation: "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –≤ Python ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ! –¢—ã —É–ø—Ä–∞–≤–ª—è–µ—à—å —á–∏—Å–ª–∞–º–∏, –∫–∞–∫ –≤–æ–ª—à–µ–±–Ω–∏–∫! –î–∞–∂–µ –µ—Å–ª–∏ –æ—à–∏–±—Å—è ‚Äî —ç—Ç–æ –æ–ø—ã—Ç!",
      },
      {
        type: "practice",
        title: "–ü—Ä–∞–∫—Ç–∏–∫–∞: –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã üéØ",
        content:
          "üéØ –°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ a = 12 –∏ b = 5. –í—ã–≤–µ–¥–∏ –∏—Ö —Å—É–º–º—É, —Ä–∞–∑–Ω–æ—Å—Ç—å, –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏ –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è.\n\nüçé –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —É —Ç–µ–±—è 12 —è–±–ª–æ–∫, –∞ —É –¥—Ä—É–≥–∞ 5. –°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ —è–±–ª–æ–∫? –°–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è, –µ—Å–ª–∏ –ø–æ–¥–µ–ª–∏—Ç—å –Ω–∞ 5?",
        code: "a = 12\nb = 5\nprint(a + b)\nprint(a - b)\nprint(a * b)\nprint(a % b)",
        task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ a = 12, b = 5 –∏ –≤—ã–≤–µ–¥–∏ —Å—É–º–º—É, —Ä–∞–∑–Ω–æ—Å—Ç—å, –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏ –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è",
        answer: "a = 12\nb = 5\nprint(a + b)\nprint(a - b)\nprint(a * b)\nprint(a % b)",
        hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π +, -, *, % –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.\n\nprint(a + b), print(a - b), print(a * b), print(a % b)",
        errorExample: {
          code: 'a = "12"\nb = 5\nprint(a + b)  # –û—à–∏–±–∫–∞! a ‚Äî —Å—Ç—Ä–æ–∫–∞, –∞ –Ω–µ —á–∏—Å–ª–æ',
          explanation: "–ï—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á–∏—Å–ª–∞, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ —Å–º–æ–∂–µ—Ç —Å–ª–æ–∂–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞.",
        },
        motivation: "–ü—Ä–∞–∫—Ç–∏–∫–∞ ‚Äî –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã! –ù–µ –±–æ–π—Å—è –æ—à–∏–±–∞—Ç—å—Å—è: –∫–∞–∂–¥–∞—è –ø–æ–ø—ã—Ç–∫–∞ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è —Å–∏–ª—å–Ω–µ–µ.",
      },
      // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø–æ—Å–ª–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
      {
        type: "additional_practice",
        title: "üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏: –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã",
        difficulty: "easy",
        content: "üçé –õ–µ–≥–∫–∏–µ –∑–∞–¥–∞—á–∏:",
        tasks: [
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ x = 8, y = 3 –∏ –≤—ã–≤–µ–¥–∏ –∏—Ö —Å—É–º–º—É –∏ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ",
            answer: "x = 8\ny = 3\nprint(x + y)\nprint(x * y)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π + –¥–ª—è —Å–ª–æ–∂–µ–Ω–∏—è, * –¥–ª—è —É–º–Ω–æ–∂–µ–Ω–∏—è"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é a = 15 –∏ –≤—ã–≤–µ–¥–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 3",
            answer: "a = 15\nprint(a / 3)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π / –¥–ª—è –¥–µ–ª–µ–Ω–∏—è"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ m = 20, n = 6 –∏ –≤—ã–≤–µ–¥–∏ –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è",
            answer: "m = 20\nn = 6\nprint(m % n)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π % –¥–ª—è –æ—Å—Ç–∞—Ç–∫–∞ –æ—Ç –¥–µ–ª–µ–Ω–∏—è"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ p = 12, q = 4 –∏ –≤—ã–≤–µ–¥–∏ –∏—Ö —Ä–∞–∑–Ω–æ—Å—Ç—å",
            answer: "p = 12\nq = 4\nprint(p - q)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π - –¥–ª—è –≤—ã—á–∏—Ç–∞–Ω–∏—è"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é z = 7 –∏ –≤—ã–≤–µ–¥–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É–º–Ω–æ–∂–µ–Ω–∏—è –Ω–∞ 3",
            answer: "z = 7\nprint(z * 3)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π * –¥–ª—è —É–º–Ω–æ–∂–µ–Ω–∏—è"
          }
        ]
      },
      {
        type: "additional_practice",
        title: "üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏: –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã",
        difficulty: "medium",
        content: "üî• –°—Ä–µ–¥–Ω–∏–µ –∑–∞–¥–∞—á–∏:",
        tasks: [
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ a = 10, b = 4 –∏ –≤—ã–≤–µ–¥–∏: —Å—É–º–º—É, —Ä–∞–∑–Ω–æ—Å—Ç—å, –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ, —á–∞—Å—Ç–Ω–æ–µ –∏ –æ—Å—Ç–∞—Ç–æ–∫",
            answer: "a = 10\nb = 4\nprint(a + b)\nprint(a - b)\nprint(a * b)\nprint(a / b)\nprint(a % b)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π –≤—Å–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã: +, -, *, /, %"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é x = 5 –∏ –≤—ã–≤–µ–¥–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–æ–∑–≤–µ–¥–µ–Ω–∏—è –≤ –∫–≤–∞–¥—Ä–∞—Ç",
            answer: "x = 5\nprint(x ** 2)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π ** –¥–ª—è –≤–æ–∑–≤–µ–¥–µ–Ω–∏—è –≤ —Å—Ç–µ–ø–µ–Ω—å"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ p = 25, q = 7 –∏ –≤—ã–≤–µ–¥–∏ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ",
            answer: "p = 25\nq = 7\nprint(p // q)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π // –¥–ª—è —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ –¥–µ–ª–µ–Ω–∏—è"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ m = 18, n = 5 –∏ –≤—ã–≤–µ–¥–∏: —Å—É–º–º—É, –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ",
            answer: "m = 18\nn = 5\nprint(m + n)\nprint(m * n)\nprint(m // n)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π +, *, // –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é y = 9 –∏ –≤—ã–≤–µ–¥–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–æ–∑–≤–µ–¥–µ–Ω–∏—è –≤ –∫—É–±",
            answer: "y = 9\nprint(y ** 3)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π ** –¥–ª—è –≤–æ–∑–≤–µ–¥–µ–Ω–∏—è –≤ —Å—Ç–µ–ø–µ–Ω—å (–∫—É–± = —Å—Ç–µ–ø–µ–Ω—å 3)"
          }
        ]
      },
      {
        type: "additional_practice",
        title: "üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏: –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã",
        difficulty: "hard",
        content: "üí™ –°–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏:",
        tasks: [
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ a = 10, b = 3 –∏ –≤—ã–≤–µ–¥–∏: —Å—É–º–º—É, –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏ –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è",
            answer: "a = 10\nb = 3\nprint(a + b)\nprint(a * b)\nprint(a % b)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π +, *, % –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ x = 6, y = 2 –∏ –≤—ã–≤–µ–¥–∏:\n1) —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ\n2) –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è\n3) –≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç–µ–ø–µ–Ω—å\n4) –æ–±—ã—á–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ",
            answer: "x = 6\ny = 2\nprint(x // y)\nprint(x % y)\nprint(x ** y)\nprint(x / y)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã:\n// –¥–ª—è —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ –¥–µ–ª–µ–Ω–∏—è\n% –¥–ª—è –æ—Å—Ç–∞—Ç–∫–∞\n** –¥–ª—è —Å—Ç–µ–ø–µ–Ω–∏\n/ –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –¥–µ–ª–µ–Ω–∏—è"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ m = 12, n = 5 –∏ –≤—ã–≤–µ–¥–∏: —Å—É–º–º—É, —Ä–∞–∑–Ω–æ—Å—Ç—å, –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏ —á–∞—Å—Ç–Ω–æ–µ",
            answer: "m = 12\nn = 5\nprint(m + n)\nprint(m - n)\nprint(m * n)\nprint(m / n)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π –æ—Å–Ω–æ–≤–Ω—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã: +, -, *, /"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ c = 16, d = 3 –∏ –≤—ã–≤–µ–¥–∏: —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ, –æ—Å—Ç–∞—Ç–æ–∫ –∏ –≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ –∫–≤–∞–¥—Ä–∞—Ç",
            answer: "c = 16\nd = 3\nprint(c // d)\nprint(c % d)\nprint(c ** 2)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π //, %, ** –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ e = 14, f = 4 –∏ –≤—ã–≤–µ–¥–∏: —Å—É–º–º—É, –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ, —á–∞—Å—Ç–Ω–æ–µ, —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ –∏ –æ—Å—Ç–∞—Ç–æ–∫",
            answer: "e = 14\nf = 4\nprint(e + f)\nprint(e * f)\nprint(e / f)\nprint(e // f)\nprint(e % f)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π –≤—Å–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã: +, *, /, //, %"
          }
        ]
      },
      {
        type: "theory",
        title: "–õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è ‚úîÔ∏è",
        content:
          "‚úîÔ∏è –õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Å—Ç—Ä–æ–∏—Ç—å —É—Å–ª–æ–≤–∏—è.\n\n==  ‚Äî —Ä–∞–≤–Ω–æ\n!=  ‚Äî –Ω–µ —Ä–∞–≤–Ω–æ\n>   ‚Äî –±–æ–ª—å—à–µ\n<   ‚Äî –º–µ–Ω—å—à–µ\n>=  ‚Äî –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ\n<=  ‚Äî –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ\n\n–õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã (and, or, not):\nand ‚Äî –∏ (True, –µ—Å–ª–∏ –æ–±–∞ —É—Å–ª–æ–≤–∏—è True)\nor  ‚Äî –∏–ª–∏ (True, –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —É—Å–ª–æ–≤–∏–µ True)\nnot ‚Äî –Ω–µ (–∏–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ)\n\nüîç –ü—Ä–µ–¥—Å—Ç–∞–≤—å:\n== ‚Äî —ç—Ç–æ –∫–∞–∫ —Å—Ä–∞–≤–Ω–∏—Ç—å –¥–≤–∞ –∫–ª—é—á–∞,\n> ‚Äî –∫—Ç–æ –≤—ã—à–µ —Ä–æ—Å—Ç–æ–º,\n< ‚Äî –∫—Ç–æ –º–ª–∞–¥—à–µ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É.\n\nüö¶ –õ–æ–≥–∏–∫–∞ ‚Äî —ç—Ç–æ –∫–∞–∫ —Å–≤–µ—Ç–æ—Ñ–æ—Ä:\n–∑–µ–ª—ë–Ω—ã–π (True) ‚Äî –º–æ–∂–Ω–æ –∏–¥—Ç–∏,\n–∫—Ä–∞—Å–Ω—ã–π (False) ‚Äî —Å—Ç–æ–π!\n\n–ü—Ä–∏–º–µ—Ä—ã:",
        code: `a = 7\nb = 3\nprint(a > b)      # True\nprint(a == b)     # False\nprint((a > 0) and (b > 0))  # True\nprint((a > 0) or (b < 0))   # True\nprint(not (a == 7))         # False`,
        explanation:
          "a –∏ b ‚Äî —á–∏—Å–ª–∞.\n\n== —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç,\n> –∏ < ‚Äî –∫—Ç–æ –±–æ–ª—å—à–µ/–º–µ–Ω—å—à–µ,\nand ‚Äî –æ–±–∞ —É—Å–ª–æ–≤–∏—è,\nor ‚Äî —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ,\nnot ‚Äî –∏–Ω–≤–µ—Ä—Å–∏—è.\n\nüéØ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞:\nage >= 18 and has_ticket ‚Äî –º–æ–∂–Ω–æ –Ω–∞ –∫–æ–Ω—Ü–µ—Ä—Ç!\n\nüö¶ –°–≤–µ—Ç–æ—Ñ–æ—Ä:\ngreen = True,\nred = False.",
        examples: [
          // ==
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä == (—Ä–∞–≤–Ω–æ)?:",
          "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è: if password == '1234': ...",
          "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã: if score == max_score:",
          // !=
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä != (–Ω–µ —Ä–∞–≤–Ω–æ)?:",
          "–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–∫–∏: if answer != correct:",
          // >
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä > (–±–æ–ª—å—à–µ)?:",
          "–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞: if age > 18:",
          // <
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä < (–º–µ–Ω—å—à–µ)?:",
          "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–∏–¥–∫–∏: if price < 100:",
          // >=
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä >= (–±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ)?:",
          "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–¥–Ω–æ–≥–æ –±–∞–ª–ª–∞: if points >= 60:",
          // <=
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä <= (–º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ)?:",
          "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞: if count <= max_count:",
          // and
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä and?:",
          "–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞ –∏ —Å–æ–≥–ª–∞—Å–∏—è: if age >= 18 and agreed:",
          // or
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä or?:",
          "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–∏–¥–∫–∏: if is_student or is_pensioner:",
          // not
          "–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä not?:",
          "–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è: if not found:",
          // –û—à–∏–±–∫–∏
          "‚ö†Ô∏è –û—à–∏–±–∫–∞: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –∏ —á–∏—Å–ª–∞!",
          "age = '18'\nif age > 17: print('–°–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏–π')  # –û—à–∏–±–∫–∞! age ‚Äî —Å—Ç—Ä–æ–∫–∞, –∞ –Ω–µ —á–∏—Å–ª–æ",
          "‚úÖ –†–µ—à–µ–Ω–∏–µ: –ø—Ä–µ–æ–±—Ä–∞–∑—É–π —Å—Ç—Ä–æ–∫—É –≤ —á–∏—Å–ª–æ!",
          "age = int(age)\nif age > 17: print('–°–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏–π')",
          "–†–µ–∑—é–º–∏—Ä—É—è:",
          "–õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã ‚Äî —Ç–≤–æ–π —Å–≤–µ—Ç–æ—Ñ–æ—Ä –∏ —Ñ–∏–ª—å—Ç—Ä! –ë–µ–∑ –Ω–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ —Å–º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è.",
        ],
        motivation: "–õ–æ–≥–∏–∫–∞ ‚Äî —Ç–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫! –° –µ—ë –ø–æ–º–æ—â—å—é –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø—Ä–∏–Ω–∏–º–∞—é—Ç —Ä–µ—à–µ–Ω–∏—è. –î–∞–∂–µ –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ ‚Äî —ç—Ç–æ —à–∞–≥ –∫ –ø–æ–Ω–∏–º–∞–Ω–∏—é!",
      },
      {
        type: "practice",
        title: "–ü—Ä–∞–∫—Ç–∏–∫–∞: –õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã ‚úîÔ∏è",
        content:
          "‚úîÔ∏è –°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é age = 16. –ü—Ä–æ–≤–µ—Ä—å, –±–æ–ª—å—à–µ –ª–∏ 18, –∏ –≤—ã–≤–µ–¥–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—å, —á—Ç–æ age –±–æ–ª—å—à–µ 10 –∏ –º–µ–Ω—å—à–µ 20.\n\nüéÇ –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç—ã –ø—Ä–æ–≤–µ—Ä—è–µ—à—å, –º–æ–∂–Ω–æ –ª–∏ –ø–æ–ø–∞—Å—Ç—å –Ω–∞ –≤–µ—á–µ—Ä–∏–Ω–∫—É (–≤–æ–∑—Ä–∞—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª—å—à–µ 18).",
        code: "age = 16\nprint(age > 18)\nprint(age > 10 and age < 20)",
        task: "–°–æ–∑–¥–∞–π age = 16, –ø—Ä–æ–≤–µ—Ä—å —É—Å–ª–æ–≤–∏—è –∏ –≤—ã–≤–µ–¥–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç",
        answer: "age = 16\nprint(age > 18)\nprint(age > 10 and age < 20)",
        hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π >, <, and –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ª–æ–≤–∏–π.\n\nprint(age > 18), print(age > 10 and age < 20)",
        errorExample: {
          code: 'age = "16"\nprint(age > 10)  # –û—à–∏–±–∫–∞! age ‚Äî —Å—Ç—Ä–æ–∫–∞, –∞ –Ω–µ —á–∏—Å–ª–æ',
          explanation: "–ï—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á–∏—Å–ª–∞, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ —Å–º–æ–∂–µ—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞.",
        },
        motivation: "–ü—Ä–æ–±—É–π —Ä–∞–∑–Ω—ã–µ —É—Å–ª–æ–≤–∏—è ‚Äî —Ç–∞–∫ —Ç—ã –Ω–∞—É—á–∏—à—å—Å—è —Å—Ç—Ä–æ–∏—Ç—å —É–º–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã! –ù–µ –±–æ–π—Å—è –æ—à–∏–±–∞—Ç—å—Å—è!",
      },
      // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø–æ—Å–ª–µ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
      {
        type: "additional_practice",
        title: "üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏: –õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã",
        difficulty: "easy",
        content: "üçé –õ–µ–≥–∫–∏–µ –∑–∞–¥–∞—á–∏:",
        tasks: [
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é age = 20 –∏ –ø—Ä–æ–≤–µ—Ä—å, –±–æ–ª—å—à–µ –ª–∏ –æ–Ω–∞ 18",
            answer: "age = 20\nprint(age > 18)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π > –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ a = 5, b = 5 –∏ –ø—Ä–æ–≤–µ—Ä—å, —Ä–∞–≤–Ω—ã –ª–∏ –æ–Ω–∏",
            answer: "a = 5\nb = 5\nprint(a == b)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π == –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é x = 10 –∏ –ø—Ä–æ–≤–µ—Ä—å, –Ω–µ —Ä–∞–≤–Ω–æ –ª–∏ x —á–∏—Å–ª—É 5",
            answer: "x = 10\nprint(x != 5)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π != –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é score = 85 –∏ –ø—Ä–æ–≤–µ—Ä—å, –±–æ–ª—å—à–µ –ª–∏ –æ–Ω–∞ 80",
            answer: "score = 85\nprint(score > 80)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π > –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ num1 = 7, num2 = 9 –∏ –ø—Ä–æ–≤–µ—Ä—å, –º–µ–Ω—å—à–µ –ª–∏ num1 —á–µ–º num2",
            answer: "num1 = 7\nnum2 = 9\nprint(num1 < num2)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π < –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è"
          }
        ]
      },
      {
        type: "additional_practice",
        title: "üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏: –õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã",
        difficulty: "medium",
        content: "üî• –°—Ä–µ–¥–Ω–∏–µ –∑–∞–¥–∞—á–∏:",
        tasks: [
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é score = 75 –∏ –ø—Ä–æ–≤–µ—Ä—å, –±–æ–ª—å—à–µ –ª–∏ –æ–Ω–∞ 60 –∏ –º–µ–Ω—å—à–µ 90",
            answer: "score = 75\nprint(score > 60 and score < 90)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π and –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —É—Å–ª–æ–≤–∏–π"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ age = 16, has_ticket = True –∏ –ø—Ä–æ–≤–µ—Ä—å, –º–æ–∂–Ω–æ –ª–∏ –Ω–∞ –∫–æ–Ω—Ü–µ—Ä—Ç (–≤–æ–∑—Ä–∞—Å—Ç >= 18 –∏ –µ—Å—Ç—å –±–∏–ª–µ—Ç)",
            answer: "age = 16\nhas_ticket = True\nprint(age >= 18 and has_ticket)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π >= –¥–ª—è '–±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ' –∏ and –¥–ª—è –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ò"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é price = 150 –∏ –ø—Ä–æ–≤–µ—Ä—å, –º–µ–Ω—å—à–µ –ª–∏ –æ–Ω–∞ 100 –∏–ª–∏ –±–æ–ª—å—à–µ 200",
            answer: "price = 150\nprint(price < 100 or price > 200)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π or –¥–ª—è –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ò–õ–ò"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ temperature = 25, is_sunny = True –∏ –ø—Ä–æ–≤–µ—Ä—å, —Ö–æ—Ä–æ—à–∞—è –ª–∏ –ø–æ–≥–æ–¥–∞ (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ > 20 –∏ —Å–æ–ª–Ω–µ—á–Ω–æ)",
            answer: "temperature = 25\nis_sunny = True\nprint(temperature > 20 and is_sunny)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π > –∏ and –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ª–æ–≤–∏–π"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é points = 95 –∏ –ø—Ä–æ–≤–µ—Ä—å, –æ—Ç–ª–∏—á–Ω—ã–π –ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–±–æ–ª—å—à–µ 90 –∏–ª–∏ —Ä–∞–≤–Ω–æ 100)",
            answer: "points = 95\nprint(points > 90 or points == 100)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π >, == –∏ or –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ª–æ–≤–∏–π"
          }
        ]
      },
      {
        type: "additional_practice",
        title: "üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏: –õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã",
        difficulty: "hard",
        content: "üí™ –°–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏:",
        tasks: [
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ x = 8, y = 4 –∏ –ø—Ä–æ–≤–µ—Ä—å:\n1) x –±–æ–ª—å—à–µ y\n2) x —Ä–∞–≤–µ–Ω y",
            answer: "x = 8\ny = 4\nprint(x > y)\nprint(x == y)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π > –∏ == –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é age = 20 –∏ –ø—Ä–æ–≤–µ—Ä—å:\n1) –≤–æ–∑—Ä–∞—Å—Ç —á—ë—Ç–Ω—ã–π (–¥–µ–ª–∏—Ç—Å—è –Ω–∞ 2 –±–µ–∑ –æ—Å—Ç–∞—Ç–∫–∞)\n2) –≤–æ–∑—Ä–∞—Å—Ç –ù–ï –±–æ–ª—å—à–µ 25",
            answer: "age = 20\nprint(age % 2 == 0)\nprint(not (age > 25))",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π % –¥–ª—è –æ—Å—Ç–∞—Ç–∫–∞ –∏ not –¥–ª—è –∏–Ω–≤–µ—Ä—Å–∏–∏"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ a = 10, b = 15 –∏ –ø—Ä–æ–≤–µ—Ä—å:\n1) a –º–µ–Ω—å—à–µ b –ò b –±–æ–ª—å—à–µ 10\n2) a —Ä–∞–≤–µ–Ω b –ò–õ–ò b –Ω–µ —Ä–∞–≤–µ–Ω 10",
            answer: "a = 10\nb = 15\nprint(a < b and b > 10)\nprint(a == b or b != 10)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π and –∏ or –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —É—Å–ª–æ–≤–∏–π"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ num = 12, limit = 20 –∏ –ø—Ä–æ–≤–µ—Ä—å:\n1) —á–∏—Å–ª–æ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 10 –¥–æ 20\n2) —á–∏—Å–ª–æ –ù–ï —Ä–∞–≤–Ω–æ 15",
            answer: "num = 12\nlimit = 20\nprint(num >= 10 and num <= limit)\nprint(not (num == 15))",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π >=, <=, and, not –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ª–æ–≤–∏–π"
          },
          {
            task: "–°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ value = 7, max_val = 10 –∏ –ø—Ä–æ–≤–µ—Ä—å:\n1) –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ–Ω—å—à–µ –º–∞–∫—Å–∏–º—É–º–∞ –ò —á—ë—Ç–Ω–æ–µ\n2) –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ 5 –ò–õ–ò –±–æ–ª—å—à–µ 8",
            answer: "value = 7\nmax_val = 10\nprint(value < max_val and value % 2 == 0)\nprint(value == 5 or value > 8)",
            hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π <, %, ==, >, and, or –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ª–æ–≤–∏–π"
          }
        ]
      },
      {
        type: "theory_practice",
        title: "üéØ –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞: –û–ø–µ—Ä–∞—Ç–æ—Ä—ã",
        content:
          "üíª –ü–æ–ø—Ä–æ–±—É–π –Ω–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è:\n1. –°–æ–∑–¥–∞—ë—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é x = 21\n2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –¥–µ–ª–∏—Ç—Å—è –ª–∏ x –Ω–∞ 7 –±–µ–∑ –æ—Å—Ç–∞—Ç–∫–∞\n3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –±–æ–ª—å—à–µ –ª–∏ x 10 –∏ –º–µ–Ω—å—à–µ 30\n4. –í—ã–≤–æ–¥–∏—Ç –æ–±–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞\n\nüçï –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —É —Ç–µ–±—è 21 –∫—É—Å–æ–∫ –ø–∏—Ü—Ü—ã –∏ 7 –¥—Ä—É–∑–µ–π. –î–µ–ª–∏—Ç—Å—è –ª–∏ –ø–∏—Ü—Ü–∞ –ø–æ—Ä–æ–≤–Ω—É?",
        code: "x = 21\nprint(x % 7 == 0)\nprint(x > 10 and x < 30)",
        expectedOutput: "True\nTrue",
        hint: "üí° –ò—Å–ø–æ–ª—å–∑—É–π %, ==, >, <, and –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ª–æ–≤–∏–π.",
      },
      {
        type: "quiz",
        title: "–ü—Ä–æ–≤–µ—Ä—å —Å–µ–±—è üß†",
        question: "–ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç print(15 // 4)?",
        options: ["3.75", "3", "4", "1"],
        correct: 1,
        hint: "üí° // ‚Äî —ç—Ç–æ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ. 15 // 4 = 3 (–æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è).",
      },
    ],
    []
  );

  // –ú–µ–º–æ–∏–∑–∏—Ä—É–µ–º —Ç–µ–∫—É—â–∏–π —à–∞–≥
  const currentStepData = useMemo(() => steps[currentStep], [steps, currentStep]);

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Ä–æ–∫–∞
  const handleLessonCompletion = useCallback(async () => {
    if (isLessonCompleted) return;

    try {
      // –ó–∞–≤–µ—Ä—à–∞–µ–º —É—Ä–æ–∫ –ª–æ–∫–∞–ª—å–Ω–æ
      const success = await completeLesson();
      if (success) {
        setLessonCompleted(true);
        setShowCongratulations(true);
        setIsLessonPassed(true);
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ localStorage
        saveLessonProgress(2);
        console.log("–£—Ä–æ–∫ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω!");

        // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫—É—Ä—Å–æ–≤ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
          navigate("/python-course");
        }, 3000);
      } else {
        console.error("–û—à–∏–±–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Ä–æ–∫–∞");
      }
    } catch (error) {
      console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —É—Ä–æ–∫–∞:", error);
    }
  }, [completeLesson, isLessonCompleted, navigate, user?.userId]);

  // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —à–∞–≥–∞
  useEffect(() => {
    const stepAnswer = getStepAnswer(currentStep);
    if (stepAnswer && stepAnswer.answer) {
      setUserAnswer(stepAnswer.answer);
      // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∑–∞–¥–∞–Ω–∏–π
      setIsCorrect(stepAnswer.isCorrect);
    } else {
      setUserAnswer("");
      setIsCorrect(null);
    }
  }, [currentStep, getStepAnswer, steps]);

  // –û—á–∏—Å—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —É—Ä–æ–∫–∞ (–µ—Å–ª–∏ —É—Ä–æ–∫ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω)
  useEffect(() => {
    if (!isLessonCompleted) {
      clearLessonProgress();
      console.log("–û—á–∏—â–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è");
    }
  }, [isLessonCompleted, clearLessonProgress]);

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  useEffect(() => {
    if (lessonProgress.progress === 0) {
      updateCurrentStep(currentStep, steps.length);
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—Ä–æ–π–¥–µ–Ω –ª–∏ —É—Ä–æ–∫
    const lessonPassed = checkLessonProgress(2);
    setIsLessonPassed(lessonPassed);
  }, [currentStep, steps.length, lessonProgress.progress, updateCurrentStep]);

  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –≤ localStorage
  const saveAnswer = (answer) => {
    saveStepAnswer(currentStep, answer);
  };

  const handleNext = () => {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –ª–∏ —Ç–µ–∫—É—â–µ–µ –∑–∞–¥–∞–Ω–∏–µ
    const currentStepData = steps[currentStep];
    let canProceed = true;

    if (currentStepData.type === "practice") {
      // –î–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ—Ç–≤–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
      if (isCorrect !== true) {
        canProceed = false;
      }
    } else if (currentStepData.type === "quiz") {
      // –î–ª—è —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ—Ç–≤–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
      if (isCorrect !== true) {
        canProceed = false;
      }
    } else if (currentStepData.type === "theory_practice") {
      // –î–ª—è —Ç–µ–æ—Ä–∏–∏ —Å –ø—Ä–∞–∫—Ç–∏–∫–æ–π –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
      if (isCorrect !== true) {
        canProceed = false;
      }
    } else if (currentStepData.type === "additional_practice") {
      // –î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ 5 –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
      const completedTasks = currentStepData.tasks.filter((_, index) => 
        additionalTaskAnswers[`${index}_correct`] === true
      );
      if (completedTasks.length < 5) {
        canProceed = false;
      }
    }

    // –ù–µ–ª—å–∑—è –ø–µ—Ä–µ–π—Ç–∏ –¥–∞–ª—å—à–µ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º —à–∞–≥–µ
    if (currentStep >= steps.length - 1) {
      canProceed = false;
    }

    if (canProceed && currentStep < steps.length - 1) {
      updateCurrentStep(currentStep + 1);
      setShowHint(false);
      setShowAnswer(false);
      setUserAnswer("");
      setAdditionalTaskAnswers({});
      setAdditionalTaskHints({});
      setAdditionalTaskAttempts({});
      setAdditionalTaskShowAnswer({});
      setIsCorrect(null);
    } else if (!canProceed) {
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
      if (currentStep >= steps.length - 1) {
        alert("üéØ –≠—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥ —É—Ä–æ–∫–∞. –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å –≤—ã—à–µ!");
      } else if (currentStepData.type === "additional_practice") {
        const completedTasks = currentStepData.tasks.filter((_, index) => 
          additionalTaskAnswers[`${index}_correct`] === true
        );
        alert(`‚ö†Ô∏è –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ 5 –∑–∞–¥–∞—á –ø—Ä–∞–≤–∏–ª—å–Ω–æ! –í—ã–ø–æ–ª–Ω–µ–Ω–æ: ${completedTasks.length}/5`);
      } else {
        alert("‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ–∫—É—â–µ–µ –∑–∞–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!");
      }
    }
  };

  const handlePrevious = () => {
    if (currentStep > 0) {
      updateCurrentStep(currentStep - 1);
      setShowHint(false);
      setShowAnswer(false);
      setUserAnswer("");
      setAdditionalTaskAnswers({});
      setAdditionalTaskHints({});
      setAdditionalTaskAttempts({});
      setAdditionalTaskShowAnswer({});
      setIsCorrect(null);
    }
  };

  // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
  const handleTextChange = useCallback((e) => {
    setUserAnswer(e.target.value);
  }, []);

  // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –≤ —Ç–µ—Å—Ç–µ
  const handleQuizAnswerChange = useCallback((e) => {
    console.log("=== –ò–ó–ú–ï–ù–ï–ù–ò–ï –û–¢–í–ï–¢–ê –í –¢–ï–°–¢–ï ===");
    console.log("e.target.value:", e.target.value);
    console.log("typeof e.target.value:", typeof e.target.value);
    setUserAnswer(e.target.value);
    console.log("setUserAnswer –≤—ã–∑–≤–∞–Ω —Å:", e.target.value);
  }, []);

  // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–∫–∞–∑–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∏
  const toggleHint = useCallback(() => {
    setShowHint((prev) => !prev);
  }, []);

  // –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ —Å –±–æ–ª–µ–µ –≥–∏–±–∫–∏–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º
  const normalizeAnswer = (answer) => {
    return answer
      .trim()
      .replace(/\s+/g, "") // –£–±–∏—Ä–∞–µ–º –≤—Å–µ –ø—Ä–æ–±–µ–ª—ã
      .replace(/["""]/g, '"') // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∫–∞–≤—ã—á–∫–∏
      .replace(/[''']/g, "'") // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
      .toLowerCase();
  };

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –æ—à–∏–±–æ–∫ –≤ –∫–æ–¥–µ
  const analyzeCodeErrors = (userCode, correctCode) => {
    const userLines = userCode.trim().split('\n').filter(line => line.trim());
    const correctLines = correctCode.trim().split('\n').filter(line => line.trim());
    
    const errors = [];
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫
    if (userLines.length < correctLines.length) {
      errors.push(`–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ç—ã –Ω–∞–ø–∏—Å–∞–ª –≤—Å–µ ${correctLines.length} —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞`);
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    if (!userCode.includes('print')) {
      errors.push('–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å —Ñ—É–Ω–∫—Ü–∏—é print() –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞');
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã
    const operators = ['+', '-', '*', '/', '//', '%', '**'];
    const missingOperators = operators.filter(op => correctCode.includes(op) && !userCode.includes(op));
    if (missingOperators.length > 0) {
      if (missingOperators.length === 1) {
        errors.push(`–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –æ–ø–µ—Ä–∞—Ç–æ—Ä ${missingOperators[0]}`);
      } else {
        errors.push(`–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã: ${missingOperators.join(', ')}`);
      }
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è
    const variablePattern = /([a-zA-Z_][a-zA-Z0-9_]*)\s*=\s*([^#\n]+)/g;
    const correctVars = {};
    const userVars = {};
    
    // –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞
    let match;
    while ((match = variablePattern.exec(correctCode)) !== null) {
      const varName = match[1].trim();
      const varValue = match[2].trim();
      correctVars[varName] = varValue;
    }
    
    // –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ –∫–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    variablePattern.lastIndex = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    while ((match = variablePattern.exec(userCode)) !== null) {
      const varName = match[1].trim();
      const varValue = match[2].trim();
      userVars[varName] = varValue;
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    const missingVars = Object.keys(correctVars).filter(varName => !userVars[varName]);
    if (missingVars.length > 0) {
      errors.push(`–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ç—ã —Å–æ–∑–¥–∞–ª –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é ${missingVars[0]}`);
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    Object.keys(correctVars).forEach(varName => {
      if (userVars[varName] && userVars[varName] !== correctVars[varName]) {
        errors.push(`–ü—Ä–æ–≤–µ—Ä—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é ${varName} - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —Ç—ã –Ω–∞–ø–∏—Å–∞–ª —á–∏—Å–ª–æ ${correctVars[varName]}`);
      }
    });
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    const comparisonOps = ['==', '!=', '>', '<', '>=', '<='];
    const missingComparison = comparisonOps.filter(op => correctCode.includes(op) && !userCode.includes(op));
    if (missingComparison.length > 0) {
      if (missingComparison.length === 1) {
        errors.push(`–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –æ–ø–µ—Ä–∞—Ç–æ—Ä —Å—Ä–∞–≤–Ω–µ–Ω–∏—è ${missingComparison[0]}`);
      } else {
        errors.push(`–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è: ${missingComparison.join(', ')}`);
      }
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
    if (userCode.includes('==') && !userCode.includes('print')) {
      errors.push('–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ç—ã –≤—ã–≤–æ–¥–∏—à—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ print()');
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã
    const logicalOps = ['and', 'or', 'not'];
    const missingLogical = logicalOps.filter(op => correctCode.includes(op) && !userCode.includes(op));
    if (missingLogical.length > 0) {
      if (missingLogical.length === 1) {
        errors.push(`–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –ª–æ–≥–∏—á–µ—Å–∫–∏–π –æ–ø–µ—Ä–∞—Ç–æ—Ä ${missingLogical[0]}`);
      } else {
        errors.push(`–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã: ${missingLogical.join(', ')}`);
      }
    }
    
    return errors;
  };

  const handleAnswerSubmit = useCallback(() => {
    console.log("=== –ù–ê–ß–ê–õ–û handleAnswerSubmit ===");
    console.log("currentStep:", currentStep);
    console.log("userAnswer:", userAnswer);
    console.log("typeof userAnswer:", typeof userAnswer);

    const currentStepData = steps[currentStep];
    console.log("currentStepData:", currentStepData);
    console.log("currentStepData.type:", currentStepData.type);

    let isAnswerCorrect = false;

    if (currentStepData.type === "practice") {
      const normalizedUserAnswer = normalizeAnswer(userAnswer);
      const normalizedCorrectAnswer = normalizeAnswer(currentStepData.answer);

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
      const isExactMatch = normalizedUserAnswer === normalizedCorrectAnswer;

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–¥–∞–Ω–∏–π
      const hasInput = normalizedUserAnswer.includes("input");
      const hasPrint = normalizedUserAnswer.includes("print");
      const hasInt = normalizedUserAnswer.includes("int");
      const hasFString = normalizedUserAnswer.includes('f"') || normalizedUserAnswer.includes("f'");
      const hasQuotes = normalizedUserAnswer.includes('"') || normalizedUserAnswer.includes("'");

      if (isExactMatch) {
        setIsCorrect(true);
        isAnswerCorrect = true;
      } else {
        // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏
        const errors = analyzeCodeErrors(userAnswer, currentStepData.answer);
        if (errors.length > 0) {
          setIsCorrect({ type: "error", errors });
        } else {
          setIsCorrect("almost");
        }
        isAnswerCorrect = false;
      }
    } else if (currentStepData.type === "quiz") {
      console.log("=== –û–ë–†–ê–ë–û–¢–ö–ê –¢–ï–°–¢–ê ===");
      console.log("userAnswer:", userAnswer);
      console.log("currentStepData.correct:", currentStepData.correct);
      console.log("typeof userAnswer:", typeof userAnswer);
      console.log("typeof currentStepData.correct:", typeof currentStepData.correct);

      // –ü—Ä–∏–≤–æ–¥–∏–º –æ–±–∞ –∑–Ω–∞—á–µ–Ω–∏—è –∫ —Å—Ç—Ä–æ–∫–∞–º –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
      const userAnswerStr = userAnswer.toString();
      const correctAnswerStr = currentStepData.correct.toString();

      console.log("userAnswerStr:", userAnswerStr);
      console.log("correctAnswerStr:", correctAnswerStr);

      isAnswerCorrect = userAnswerStr === correctAnswerStr;
      console.log("isAnswerCorrect:", isAnswerCorrect);

      setIsCorrect(isAnswerCorrect);
      console.log("setIsCorrect –≤—ã–∑–≤–∞–Ω —Å:", isAnswerCorrect);
    } else if (currentStepData.type === "additional_practice") {
      // –î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á –ø—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–≤–µ—Ç—ã –ø–æ –æ—á–µ—Ä–µ–¥–∏
      const normalizedUserAnswer = normalizeAnswer(userAnswer);
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –∑–∞–¥–∞—á–∏ –≤ —Ç–µ–∫—É—â–µ–º –±–ª–æ–∫–µ
      let foundCorrectAnswer = false;
      for (const task of currentStepData.tasks) {
        const normalizedCorrectAnswer = normalizeAnswer(task.answer);
        if (normalizedUserAnswer === normalizedCorrectAnswer) {
          foundCorrectAnswer = true;
          break;
        }
      }
      
      setIsCorrect(foundCorrectAnswer);
      isAnswerCorrect = foundCorrectAnswer;
    }

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç–≤–µ—Ç
    console.log("=== –°–û–•–†–ê–ù–ï–ù–ò–ï –û–¢–í–ï–¢–ê ===");
    console.log("currentStep:", currentStep);
    console.log("userAnswer:", userAnswer);
    console.log("isAnswerCorrect:", isAnswerCorrect);

    saveStepAnswer(currentStep, userAnswer, isAnswerCorrect);
    console.log("=== –ö–û–ù–ï–¶ handleAnswerSubmit ===");
  }, [currentStep, steps, userAnswer, normalizeAnswer, saveStepAnswer]);

  return (
    <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className="max-w-4xl mx-auto p-6 mb-5">
      {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ–º */}
      {showCongratulations && (
        <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <motion.div
            initial={{ scale: 0.5, opacity: 0 }}
            animate={{ scale: 1, opacity: 1 }}
            className="bg-white rounded-2xl p-8 max-w-md mx-4 text-center shadow-2xl"
          >
            <div className="text-6xl mb-4 animate-bounce">üéâ</div>
            <h2 className="text-2xl font-bold text-gray-800 mb-4">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
            <p className="text-gray-600 mb-6">–í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∏–ª–∏ —É—Ä–æ–∫ "–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –í—ã–≤–æ–¥ –∏ –≤–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö"!</p>
            <div className="bg-green-50 rounded-lg p-4 mb-6">
              <p className="text-green-800 font-medium mb-2">üéØ –í—ã –∏–∑—É—á–∏–ª–∏:</p>
              <ul className="text-green-700 text-sm space-y-1">
                <li>‚Ä¢ –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</li>
                <li>‚Ä¢ –§—É–Ω–∫—Ü–∏–∏ print() –∏ input()</li>
                <li>‚Ä¢ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö</li>
                <li>‚Ä¢ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫</li>
              </ul>
            </div>
            <p className="text-gray-500 text-sm">–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫—É—Ä—Å–æ–≤ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã...</p>
            <div className="mt-4">
              <div className="w-full bg-gray-200 rounded-full h-2">
                <motion.div className="bg-green-500 h-2 rounded-full" initial={{ width: 0 }} animate={{ width: "100%" }} transition={{ duration: 3 }} />
              </div>
            </div>
          </motion.div>
        </motion.div>
      )}


      {/* –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä */}
      <div className="mb-8">
        <div className="flex justify-between items-center mb-2">
          <div className="flex items-center space-x-2">
            <span className="text-sm font-medium text-gray-600">üìö –£—Ä–æ–∫ 4: –û–ø–µ—Ä–∞—Ç–æ—Ä—ã –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è</span>
            {isLessonPassed && <span className="text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full font-medium">‚úÖ –ü—Ä–æ–π–¥–µ–Ω</span>}
          </div>
          <div className="flex items-center space-x-4">
            <span className="text-sm font-medium text-gray-600">üìç {currentStep + 1} –∏–∑ {steps.length}</span>
            <span className="text-sm font-medium text-green-600">{Math.round(((currentStep + 1) / steps.length) * 100)}%</span>
          </div>
        </div>
        <div className="w-full bg-gray-200 rounded-full h-3">
          <motion.div
            className="bg-gradient-to-r from-green-500 to-blue-500 h-3 rounded-full"
            initial={{ width: 0 }}
            animate={{ width: `${((currentStep + 1) / steps.length) * 100}%` }}
            transition={{ duration: 0.5 }}
          />
        </div>
      </div>

      {/* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */}
      <div className="bg-white rounded-xl shadow-xl p-8 mb-8 border border-gray-100">
        <motion.h1
          key={currentStep}
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          className="text-3xl font-bold text-gray-800 mb-6 text-center"
        >
          {currentStepData.title}
        </motion.h1>

        <motion.div key={`content-${currentStep}`} initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} className="space-y-6">
          {/* –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç */}
          {currentStepData.content && (
            <div className="text-gray-700 leading-relaxed text-lg">
              {(() => {
                const lines = currentStepData.content.split("\n");
                const result = [];
                let currentMetaphorBlock = [];
                let inMetaphorBlock = false;

                lines.forEach((line, index) => {
                  // –ù–∞—á–∞–ª–æ –±–ª–æ–∫–∞ –º–µ—Ç–∞—Ñ–æ—Ä—ã
                  if (line.trim().startsWith("üì¶ –ü—Ä–µ–¥—Å—Ç–∞–≤—å:") || line.trim().startsWith("üí∞ –í –º–∞–≥–∞–∑–∏–Ω–µ:") || line.trim().startsWith("üîç –ü—Ä–µ–¥—Å—Ç–∞–≤—å:") || line.trim().startsWith("üö¶ –õ–æ–≥–∏–∫–∞ ‚Äî —ç—Ç–æ –∫–∞–∫ —Å–≤–µ—Ç–æ—Ñ–æ—Ä:")) {
                    // –ï—Å–ª–∏ –±—ã–ª –ø—Ä–µ–¥—ã–¥—É—â–∏–π –±–ª–æ–∫ –º–µ—Ç–∞—Ñ–æ—Ä—ã, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ
                    if (inMetaphorBlock && currentMetaphorBlock.length > 0) {
                      result.push(
                        <div key={`metaphor-${index}`} className="bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-300 rounded-xl p-6 shadow-lg mb-6">
                          <div className="flex items-center mb-4">
                            <span className="text-2xl mr-3">üé≠</span>
                            <span className="text-purple-800 font-bold text-xl">–ú–µ—Ç–∞—Ñ–æ—Ä–∞</span>
                          </div>
                          <div className="space-y-3">
                            {currentMetaphorBlock.map((metaphorLine, i) => (
                              <p key={i} className="text-purple-700 text-lg">
                                {metaphorLine}
                              </p>
                            ))}
                          </div>
                        </div>
                      );
                      currentMetaphorBlock = [];
                    }
                    inMetaphorBlock = true;
                    currentMetaphorBlock.push(line);
                  } else if (inMetaphorBlock) {
                    // –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –±–ª–æ–∫–∞ –º–µ—Ç–∞—Ñ–æ—Ä—ã
                    if (line.trim() === "") {
                      // –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ - –∫–æ–Ω–µ—Ü –±–ª–æ–∫–∞ –º–µ—Ç–∞—Ñ–æ—Ä—ã
                      if (currentMetaphorBlock.length > 0) {
                        result.push(
                          <div key={`metaphor-${index}`} className="bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-300 rounded-xl p-6 shadow-lg mb-6">
                            <div className="flex items-center mb-4">
                              <span className="text-2xl mr-3">üé≠</span>
                              <span className="text-purple-800 font-bold text-xl">–ú–µ—Ç–∞—Ñ–æ—Ä–∞</span>
                            </div>
                            <div className="space-y-3">
                              {currentMetaphorBlock.map((metaphorLine, i) => (
                                <p key={i} className="text-purple-700 text-lg">
                                  {metaphorLine}
                                </p>
                              ))}
                            </div>
                          </div>
                        );
                        currentMetaphorBlock = [];
                      }
                      inMetaphorBlock = false;
                    } else {
                      currentMetaphorBlock.push(line);
                    }
                  } else {
                    // –û–±—ã—á–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
                    result.push(
                      <p key={index} className="mb-3">
                        {line}
                      </p>
                    );
                  }
                });

                // –ï—Å–ª–∏ –æ—Å—Ç–∞–ª—Å—è –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–π –±–ª–æ–∫ –º–µ—Ç–∞—Ñ–æ—Ä—ã
                if (inMetaphorBlock && currentMetaphorBlock.length > 0) {
                  result.push(
                    <div key={`metaphor-final`} className="bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-300 rounded-xl p-6 shadow-lg mb-6">
                      <div className="flex items-center mb-4">
                        <span className="text-2xl mr-3">üé≠</span>
                        <span className="text-purple-800 font-bold text-xl">–ú–µ—Ç–∞—Ñ–æ—Ä–∞</span>
                      </div>
                      <div className="space-y-3">
                        {currentMetaphorBlock.map((metaphorLine, i) => (
                          <p key={i} className="text-purple-700 text-lg">
                            {metaphorLine}
                          </p>
                        ))}
                      </div>
                    </div>
                  );
                }

                return result;
              })()}
            </div>
          )}

          {/* –ö–æ–¥ */}
          {currentStepData.code && currentStepData.type !== "theory_practice" && (
            <div className="bg-gradient-to-r from-gray-900 to-gray-800 rounded-xl p-6 shadow-lg">
              <div className="flex items-center mb-4">
                <span className="text-green-400 font-medium flex items-center">üêç Python</span>
              </div>
              <pre className="text-green-400 overflow-x-auto text-lg select-none pointer-events-none">
                <code>{currentStepData.code}</code>
              </pre>
            </div>
          )}

          {/* –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ */}
          {currentStepData.explanation && currentStepData.type !== "theory_practice" && (
            <div className="bg-gradient-to-r from-blue-50 to-indigo-50 border-l-4 border-blue-400 p-6 rounded-xl">
              <div className="flex items-center mb-2">
                <span className="text-2xl mr-2">üí°</span>
                <span className="text-blue-800 font-semibold">–û–±—ä—è—Å–Ω–µ–Ω–∏–µ</span>
              </div>
              <div className="text-blue-800 text-lg">
                {currentStepData.explanation.split("\n").map((line, index) => (
                  <p key={index} className="mb-3">
                    {line}
                  </p>
                ))}
              </div>
            </div>
          )}

          {/* –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –Ω–æ–≤–∏—á–∫–æ–≤ */}
          {currentStepData.errorExample && (
            <div className="bg-gradient-to-r from-red-50 to-pink-50 border-l-4 border-red-400 p-4 rounded-xl mb-4">
              <div className="flex items-center mb-2">
                <span className="text-xl mr-2">‚ö†Ô∏è</span>
                <span className="text-red-800 font-semibold">–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –Ω–æ–≤–∏—á–∫–æ–≤:</span>
              </div>
              <div className="text-red-800 text-lg">
                <pre className="bg-gray-900 rounded-lg p-3 text-red-300 text-sm mb-2 overflow-x-auto">{currentStepData.errorExample.code}</pre>
                <div>{currentStepData.errorExample.explanation}</div>
              </div>
            </div>
          )}

          {/* –ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä) */}
          {currentStepData.examples && (
            <div className="space-y-8 mb-4">
              <div className="flex items-center mb-2">
                <span className="text-xl mr-2">üõ†Ô∏è</span>
                <span className="text-green-800 font-semibold text-lg">–†–∞–∑–±–æ—Ä –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤:</span>
              </div>
              {/* –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö –∏ —Å–±–æ—Ä —Ä–µ–∑—é–º–µ */}
              {(() => {
                // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–±–∏—Ä–∞–µ–º —Ä–µ–∑—é–º–µ –æ—Ç–¥–µ–ª—å–Ω–æ
                const groups = [];
                let currentGroup = null;
                let currentType = null;
                const typeRegex = /–ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä (.+)\?:/i;
                const resumeBlocks = [];

                let inResume = false;
                let currentResume = [];
                currentStepData.examples.forEach((ex, i) => {
                  // –ù–∞—á–∞–ª–æ —Ä–µ–∑—é–º–µ
                  if (ex.trim().startsWith("–†–µ–∑—é–º–∏—Ä—É—è:") || ex.trim().startsWith("–†–µ–∑—é–º–∏—Ä—É—è:")) {
                    if (currentResume.length > 0) {
                      resumeBlocks.push([...currentResume]);
                      currentResume = [];
                    }
                    inResume = true;
                    currentResume.push(ex);
                    return;
                  }
                  // –ï—Å–ª–∏ –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏ –Ω–æ–≤—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö ‚Äî –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ä–µ–∑—é–º–µ, –µ—Å–ª–∏ –æ–Ω–æ –±—ã–ª–æ
                  const match = ex.match(typeRegex);
                  if (match) {
                    if (inResume && currentResume.length > 0) {
                      resumeBlocks.push([...currentResume]);
                      currentResume = [];
                      inResume = false;
                    }
                    if (currentGroup) groups.push(currentGroup);
                    currentType = match[1].trim();
                    currentGroup = {
                      type: currentType,
                      items: [
                        {
                          type: "header",
                          content: ex,
                        },
                      ],
                    };
                    return;
                  }
                  // –ï—Å–ª–∏ –º—ã –≤ —Ä–µ–∑—é–º–µ ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å–æ–±–∏—Ä–∞—Ç—å
                  if (inResume) {
                    currentResume.push(ex);
                    return;
                  }
                  // –û–±—ã—á–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö
                  if (currentGroup) {
                    currentGroup.items.push({ type: "item", content: ex });
                  }
                });
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Ä–µ–∑—é–º–µ, –µ—Å–ª–∏ –æ–Ω–æ –±—ã–ª–æ
                if (inResume && currentResume.length > 0) {
                  resumeBlocks.push([...currentResume]);
                }
                if (currentGroup) groups.push(currentGroup);
                // –†–µ–Ω–¥–µ—Ä–∏–º –≥—Ä—É–ø–ø—ã —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
                return (
                  <>
                    {groups.map((group, idx) => (
                      <div
                        key={idx}
                        className="bg-gradient-to-r from-gray-50 to-gray-100 border-2 border-green-300 rounded-2xl shadow-lg p-6 space-y-4 animate-fade-in"
                      >
                        <div className="flex items-center mb-2">
                          <span className="text-2xl mr-2">üîπ</span>
                          <span className="text-green-900 font-bold text-xl">–û–ø–µ—Ä–∞—Ç–æ—Ä: {group.type}</span>
                        </div>
                        <div className="space-y-4">
                          {group.items.map((item, i) => {
                            const ex = item.content;
                            // –ë–ª–æ–∫: –ì–¥–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö ... (–∑–∞–≥–æ–ª–æ–≤–æ–∫)
                            if (item.type === "header") {
                              return (
                                <div
                                  key={i}
                                  className="bg-gradient-to-r from-yellow-100 to-yellow-50 border-l-4 border-yellow-400 shadow-md rounded-xl p-4 flex items-center space-x-3 animate-fade-in"
                                >
                                  <span className="text-2xl">üì¶</span>
                                  <span className="text-yellow-900 font-semibold text-base">{ex}</span>
                                </div>
                              );
                            }
                            // –ë–ª–æ–∫: –û—à–∏–±–∫–∞
                            if (ex.trim().startsWith("‚ö†Ô∏è") || ex.trim().startsWith("‚ùå")) {
                              return (
                                <div
                                  key={i}
                                  className="bg-gradient-to-r from-red-100 to-pink-50 border-l-4 border-red-400 shadow-md rounded-xl p-4 flex items-center space-x-3 animate-fade-in"
                                >
                                  <span className="text-2xl">‚ö†Ô∏è</span>
                                  <span className="text-red-900 font-semibold text-base">{ex}</span>
                                </div>
                              );
                            }
                            // –ë–ª–æ–∫: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
                            if (ex.trim().startsWith("‚úÖ")) {
                              return (
                                <div
                                  key={i}
                                  className="bg-gradient-to-r from-green-100 to-emerald-50 border-l-4 border-green-400 shadow-md rounded-xl p-4 flex items-center space-x-3 animate-fade-in"
                                >
                                  <span className="text-2xl">‚úÖ</span>
                                  <span className="text-green-900 font-semibold text-base">{ex}</span>
                                </div>
                              );
                            }
                            // –ë–ª–æ–∫: –ü—Ä–∏–º–µ—Ä (–∫–æ–¥)
                            const isCode =
                              ex.trim().match(/^[a-zA-Z_][a-zA-Z0-9_ ]* ?=|print\(|total ?=|score ?=|item[12] ?=|result ?=|^#|^\d+\./) ||
                              ex.trim() === "score + 10";
                            if (isCode) {
                              return (
                                <pre
                                  key={i}
                                  className="bg-gray-900 rounded-xl p-3 text-green-300 text-sm mb-2 overflow-x-auto border border-gray-700 animate-fade-in"
                                >
                                  {ex}
                                </pre>
                              );
                            }
                            // –ë–ª–æ–∫: –û–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç
                            return (
                              <div
                                key={i}
                                className="bg-gradient-to-r from-blue-50 to-blue-100 border-l-4 border-blue-400 shadow rounded-xl p-4 text-blue-900 animate-fade-in"
                              >
                                {ex}
                              </div>
                            );
                          })}
                        </div>
                      </div>
                    ))}
                    {/* –†–µ–∑—é–º–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å–µ–∫—Ü–∏—è–º–∏ */}
                    {resumeBlocks.length > 0 && (
                      <div className="space-y-6 mt-16">
                        {resumeBlocks.map((resumeArr, i) => (
                          <div key={i} className="bg-white border border-gray-200 shadow rounded-2xl p-6 flex items-start space-x-4 animate-fade-in">
                            <span className="text-3xl mt-1 text-blue-400">üìå</span>
                            <div className="space-y-2 w-full">
                              {resumeArr.map((ex, j) =>
                                j === 0 ? (
                                  <div key={j} className="text-lg font-semibold text-blue-800 mb-1">
                                    {ex.replace(/–†–µ–∑—é–º–∏—Ä—É—è:/, "–†–µ–∑—é–º–∏—Ä—É—è:")}
                                  </div>
                                ) : (
                                  <div key={j} className="text-base text-gray-800 leading-relaxed">
                                    {ex}
                                  </div>
                                )
                              )}
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </>
                );
              })()}
            </div>
          )}

          {/* –ü–æ—è—Å–Ω–µ–Ω–∏–µ –æ —Ç–∏–ø–∞—Ö –¥–∞–Ω–Ω—ã—Ö */}
          {/* {currentStepData.examples && (
            <div className="mt-4 text-green-900 text-base bg-green-50 border-l-4 border-green-400 rounded p-3">
              <span className="font-semibold">–í–∞–∂–Ω–æ:</span> –≠—Ç–æ –Ω–µ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä,{" "}
              <span className="font-mono">int</span>). –ü—Ä–æ—Å—Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ –µ—Å—Ç—å —Å–≤–æ–π –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö: –¥–ª—è —á–∏—Å–µ–ª ‚Äî{" "}
              <span className="font-mono">int</span> –∏–ª–∏ <span className="font-mono">float</span>, –¥–ª—è —Ç–µ–∫—Å—Ç–∞ ‚Äî <span className="font-mono">str</span>, –¥–ª—è
              –æ—Ç–≤–µ—Ç–æ–≤ "–¥–∞/–Ω–µ—Ç" ‚Äî <span className="font-mono">bool</span>. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç —Ç–∏–ø, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤–∞—à–µ–π –∑–∞–¥–∞—á–∏!
            </div>
          )} */}

          {/* –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ */}
          {currentStepData.type === "practice" && (
            <div className="bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-xl p-6 shadow-lg">
              <h3 className="text-xl font-semibold text-yellow-800 mb-4 flex items-center">
                <span className="text-2xl mr-2">üéØ</span>
                –ó–∞–¥–∞–Ω–∏–µ
              </h3>
              <p className="text-yellow-700 mb-4 text-lg">{currentStepData.task}</p>

              <div className="space-y-4">
                <textarea
                  value={userAnswer}
                  onChange={handleTextChange}
                  placeholder="‚úçÔ∏è –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∫–æ–¥ –∑–¥–µ—Å—å..."
                  className="w-full h-60 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-lg font-mono resize-none"
                  spellCheck="false"
                />

                <div className="flex space-x-4">
                  <button
                    onClick={handleAnswerSubmit}
                    className="px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 transition-all duration-200 flex items-center space-x-2 shadow-lg"
                  >
                    <span>‚úÖ</span>
                    <span>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</span>
                  </button>
                  <button
                    onClick={toggleHint}
                    className="px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-200 flex items-center space-x-2 shadow-lg"
                  >
                    <span>üí°</span>
                    <span>–ü–æ–¥—Å–∫–∞–∑–∫–∞</span>
                  </button>
                </div>

                {showHint && (
                  <div className="bg-gradient-to-r from-blue-100 to-indigo-100 border border-blue-300 rounded-lg p-4">
                    <div className="flex items-center mb-2">
                      <span className="text-xl mr-2">üí°</span>
                      <span className="text-blue-800 font-semibold">–ü–æ–¥—Å–∫–∞–∑–∫–∞</span>
                    </div>
                    <div className="text-blue-800 text-lg">
                      {currentStepData.hint.split("\n").map((line, index) => (
                        <p key={index} className="mb-3">
                          {line}
                        </p>
                      ))}
                    </div>
                  </div>
                )}

                {isCorrect !== null && (
                  <div
                    className={`p-4 rounded-lg ${
                      isCorrect === true
                        ? "bg-gradient-to-r from-green-100 to-emerald-100 border border-green-300"
                        : isCorrect === "almost"
                        ? "bg-gradient-to-r from-yellow-100 to-orange-100 border border-yellow-300"
                        : "bg-gradient-to-r from-red-100 to-pink-100 border border-red-300"
                    }`}
                  >
                    {isCorrect === true ? (
                      <p className="text-green-800 text-lg font-semibold">
                        üéâ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É.
                      </p>
                    ) : isCorrect === "almost" ? (
                      <p className="text-yellow-800 text-lg font-semibold">
                        ‚ö†Ô∏è –û—Ç–≤–µ—Ç –ø–æ—á—Ç–∏ –≤–µ—Ä–Ω—ã–π, –Ω–æ –ø—Ä–æ–≤–µ—Ä—å —Å–∫–æ–±–∫–∏ –∏ –∫–∞–≤—ã—á–∫–∏. –£–±–µ–¥–∏—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏ –∏ –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤.
                      </p>
                    ) : isCorrect.type === "error" ? (
                      <div className="text-red-800">
                        <p className="text-lg font-semibold mb-3">‚ùå –ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ–π –∫–æ–¥:</p>
                        <ul className="space-y-2">
                          {isCorrect.errors.map((error, index) => (
                            <li key={index} className="flex items-start space-x-2">
                              <span className="text-red-600 mt-1">‚Ä¢</span>
                              <span className="text-base">{error}</span>
                            </li>
                          ))}
                        </ul>
                      </div>
                    ) : (
                      <p className="text-red-800 text-lg font-semibold">
                        ‚ùå –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å.
                      </p>
                    )}
                  </div>
                )}

                {/* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è */}
                {currentStepData.type === "practice" && isCorrect === null && (
                  <div className="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4">
                    <div className="flex items-center">
                      <span className="text-xl mr-2">‚ÑπÔ∏è</span>
                      <p className="text-blue-800 text-lg">–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É</p>
                    </div>
                  </div>
                )}
              </div>
            </div>
          )}

          {/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ */}
          {currentStepData.type === "additional_practice" && (
            <div className="bg-gradient-to-r from-indigo-50 to-purple-50 border border-indigo-200 rounded-xl p-6 shadow-lg">
              <div className="flex items-center justify-between mb-4">
                <h3 className="text-xl font-semibold text-indigo-800 flex items-center">
                  {currentStepData.title}
                </h3>
                <div className="flex items-center space-x-2">
                  <span className="text-sm font-medium text-indigo-700">
                    –í—ã–ø–æ–ª–Ω–µ–Ω–æ: {currentStepData.tasks.filter((_, index) => additionalTaskAnswers[`${index}_correct`] === true).length}/5
                  </span>
                  <div className="w-16 h-2 bg-indigo-200 rounded-full overflow-hidden">
                    <div 
                      className="h-full bg-gradient-to-r from-green-500 to-green-600 transition-all duration-300"
                      style={{ 
                        width: `${(currentStepData.tasks.filter((_, index) => additionalTaskAnswers[`${index}_correct`] === true).length / 5) * 100}%` 
                      }}
                    />
                  </div>
                </div>
              </div>
              <p className="text-indigo-700 mb-6 text-lg">{currentStepData.content}</p>

              <div className="space-y-6">
                {currentStepData.tasks.map((task, index) => (
                  <div key={index} className="bg-white border border-indigo-200 rounded-lg p-4 shadow-md">
                    <h4 className="text-lg font-semibold text-indigo-800 mb-3">
                      –ó–∞–¥–∞—á–∞ {index + 1}:
                    </h4>
                    <p className="text-gray-700 mb-4 text-lg">{task.task}</p>
                    
                                         <div className="space-y-3">
                       <textarea
                         value={additionalTaskAnswers[index] || ""}
                         onChange={(e) => {
                           setAdditionalTaskAnswers(prev => ({
                             ...prev,
                             [index]: e.target.value
                           }));
                         }}
                         placeholder="‚úçÔ∏è –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∫–æ–¥ –∑–¥–µ—Å—å..."
                         className="w-full h-40 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-base font-mono resize-none"
                         spellCheck="false"
                       />

                       <div className="flex space-x-3">
                         <button
                           onClick={() => {
                             const answer = additionalTaskAnswers[index] || "";
                             const normalizedUserAnswer = normalizeAnswer(answer);
                             const normalizedCorrectAnswer = normalizeAnswer(task.answer);
                             const isCorrect = normalizedUserAnswer === normalizedCorrectAnswer;
                             
                             // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ—Ç–≤–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
                             if (!isCorrect) {
                               const currentAttempts = additionalTaskAttempts[index] || 0;
                               const newAttempts = currentAttempts + 1;
                               setAdditionalTaskAttempts(prev => ({
                                 ...prev,
                                 [index]: newAttempts
                               }));
                             }
                             
                             let result;
                             if (isCorrect) {
                               result = true;
                             } else {
                               const errors = analyzeCodeErrors(answer, task.answer);
                               result = { type: "error", errors };
                             }
                             
                             // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏
                             setAdditionalTaskAnswers(prev => ({
                               ...prev,
                               [`${index}_correct`]: result
                             }));
                           }}
                           disabled={!additionalTaskAnswers[index] || additionalTaskAnswers[index].trim() === ""}
                           className={`px-4 py-2 rounded-lg transition-all duration-200 flex items-center space-x-2 shadow-md text-sm ${
                             additionalTaskAnswers[index] && additionalTaskAnswers[index].trim() !== ""
                               ? "bg-gradient-to-r from-indigo-500 to-indigo-600 text-white hover:from-indigo-600 hover:to-indigo-700"
                               : "bg-gray-300 text-gray-500 cursor-not-allowed"
                           }`}
                         >
                           <span>‚úÖ</span>
                           <span>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</span>
                         </button>
                         <button
                           onClick={() => {
                             setAdditionalTaskHints(prev => ({
                               ...prev,
                               [index]: !prev[index]
                             }));
                           }}
                           className="px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-200 flex items-center space-x-2 shadow-md text-sm"
                         >
                           <span>üí°</span>
                           <span>–ü–æ–¥—Å–∫–∞–∑–∫–∞</span>
                         </button>
                         <button
                           onClick={() => {
                             setAdditionalTaskShowAnswer(prev => ({
                               ...prev,
                               [index]: !prev[index]
                             }));
                           }}
                           disabled={additionalTaskAnswers[`${index}_correct`] !== true && (additionalTaskAttempts[index] || 0) < 5}
                           className={`px-4 py-2 rounded-lg transition-all duration-200 flex items-center space-x-2 shadow-md text-sm ${
                             additionalTaskAnswers[`${index}_correct`] === true || (additionalTaskAttempts[index] || 0) >= 5
                               ? "bg-gradient-to-r from-purple-500 to-purple-600 text-white hover:from-purple-600 hover:to-purple-700"
                               : "bg-gray-300 text-gray-500 cursor-not-allowed"
                           }`}
                         >
                           <span>üéØ</span>
                           <span>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</span>
                           {additionalTaskAnswers[`${index}_correct`] !== true && (additionalTaskAttempts[index] || 0) < 5 && (
                             <span className="text-xs">({additionalTaskAttempts[index] || 0}/5)</span>
                           )}
                         </button>
                       </div>

                                             {additionalTaskHints[index] && (
                         <div className="bg-gradient-to-r from-blue-100 to-indigo-100 border border-blue-300 rounded-lg p-3">
                           <div className="flex items-center mb-2">
                             <span className="text-lg mr-2">üí°</span>
                             <span className="text-blue-800 font-semibold">–ü–æ–¥—Å–∫–∞–∑–∫–∞</span>
                           </div>
                           <div className="text-blue-800 text-base">
                             {task.hint}
                           </div>
                         </div>
                       )}

                                             {additionalTaskAnswers[`${index}_correct`] !== undefined && (
                         <div
                           className={`p-3 rounded-lg ${
                             additionalTaskAnswers[`${index}_correct`] === true
                               ? "bg-gradient-to-r from-green-100 to-emerald-100 border border-green-300"
                               : "bg-gradient-to-r from-red-100 to-pink-100 border border-red-300"
                           }`}
                         >
                           {additionalTaskAnswers[`${index}_correct`] === true ? (
                             <p className="text-green-800 text-base font-semibold">
                               üéâ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!
                             </p>
                           ) : additionalTaskAnswers[`${index}_correct`].type === "error" ? (
                             <div className="text-red-800">
                               <p className="text-base font-semibold mb-2">‚ùå –ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ–π –∫–æ–¥:</p>
                               <ul className="space-y-1">
                                 {additionalTaskAnswers[`${index}_correct`].errors.map((error, errorIndex) => (
                                   <li key={errorIndex} className="flex items-start space-x-2">
                                     <span className="text-red-600 mt-1">‚Ä¢</span>
                                     <span className="text-sm">{error}</span>
                                   </li>
                                 ))}
                               </ul>
                             </div>
                           ) : (
                             <p className="text-red-800 text-base font-semibold">
                               ‚ùå –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å.
                             </p>
                           )}
                         </div>
                       )}

                       {/* –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç */}
                       {additionalTaskShowAnswer[index] && (
                         <div className="bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-3">
                           <div className="flex items-center mb-2">
                             <span className="text-lg mr-2">üéØ</span>
                             <span className="text-purple-800 font-semibold">–û—Ç–≤–µ—Ç:</span>
                           </div>
                           <div className="bg-gradient-to-r from-gray-900 to-gray-800 rounded-lg p-4 shadow-lg">
                             <div className="flex items-center mb-2">
                               <span className="text-green-400 font-medium text-sm">üêç Python</span>
                             </div>
                             <pre className="text-green-400 overflow-x-auto text-sm select-none pointer-events-none">
                               <code>{task.answer}</code>
                             </pre>
                           </div>
                         </div>
                       )}
                    </div>
                  </div>
                ))}
              </div>

              {/* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞—á */}
              {(() => {
                const completedTasks = currentStepData.tasks.filter((_, index) => 
                  additionalTaskAnswers[`${index}_correct`] === true
                );
                const totalTasks = currentStepData.tasks.length;
                
                if (completedTasks.length === 0) {
                  return (
                    <div className="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4 mt-6">
                      <div className="flex items-center">
                        <span className="text-xl mr-2">‚ÑπÔ∏è</span>
                        <p className="text-blue-800 text-lg">–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ 5 –∑–∞–¥–∞—á –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É</p>
                      </div>
                    </div>
                  );
                } else if (completedTasks.length < totalTasks) {
                  return (
                    <div className="bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg p-4 mt-6">
                      <div className="flex items-center">
                        <span className="text-xl mr-2">üéØ</span>
                        <p className="text-yellow-800 text-lg">–û—Ç–ª–∏—á–Ω–æ! –í—ã–ø–æ–ª–Ω–µ–Ω–æ {completedTasks.length} –∏–∑ {totalTasks} –∑–∞–¥–∞—á. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ!</p>
                      </div>
                    </div>
                  );
                } else {
                  return (
                    <div className="bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4 mt-6">
                      <div className="flex items-center">
                        <span className="text-xl mr-2">üéâ</span>
                        <p className="text-green-800 text-lg font-semibold">–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! –í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ! –ú–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É.</p>
                      </div>
                    </div>
                  );
                }
              })()}
            </div>
          )}

          {/* –¢–µ–æ—Ä–∏—è —Å –ø—Ä–∞–∫—Ç–∏–∫–æ–π */}
          {currentStepData.type === "theory_practice" && (
            <div className="bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl p-6 shadow-lg">
              <h3 className="text-xl font-semibold text-emerald-800 mb-4 flex items-center">
                <span className="text-2xl mr-2">üíª</span>
                –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞
              </h3>

              <div className="space-y-6">
                {/* –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç */}
                <div className="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4">
                  <div className="flex items-center mb-2">
                    <span className="text-xl mr-2">üéØ</span>
                    <span className="text-blue-800 font-semibold">–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</span>
                  </div>
                  <div className="bg-gray-900 rounded-lg p-4">
                    <pre className="text-green-400 text-lg font-mono">{currentStepData.expectedOutput}</pre>
                  </div>
                </div>

                {/* –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ */}
                <div className="bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg p-4">
                  <div className="flex items-center mb-2">
                    <span className="text-xl mr-2">üìù</span>
                    <span className="text-yellow-800 font-semibold">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:</span>
                  </div>
                  <ol className="text-yellow-700 text-lg space-y-2">
                    <li>1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞ (PyCharm, VS Code, IDLE –∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π)</li>
                    <li>2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .py</li>
                    <li>3. –ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–¥ —Å–æ–≥–ª–∞—Å–Ω–æ –∑–∞–¥–∞–Ω–∏—é</li>
                    <li>4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç</li>
                    <li>5. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–≤–æ–¥ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –æ–∂–∏–¥–∞–µ–º—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º</li>
                    <li>6. –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç–µ –≥–æ—Ç–æ–≤—ã, –Ω–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"</li>
                  </ol>
                </div>

                {/* –ö–Ω–æ–ø–∫–∏ */}
                <div className="flex space-x-4">
                  <button
                    onClick={() => {
                      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–º–µ—á–∞–µ–º –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ
                      setIsCorrect(true);
                      saveStepAnswer(currentStep, "theory_practice_completed", true);
                    }}
                    className="px-6 py-3 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white rounded-lg hover:from-emerald-600 hover:to-emerald-700 transition-all duration-200 flex items-center space-x-2 shadow-lg"
                  >
                    <span>‚úÖ</span>
                    <span>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</span>
                  </button>
                  <button
                    onClick={toggleHint}
                    className="px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-200 flex items-center space-x-2 shadow-lg"
                  >
                    <span>üí°</span>
                    <span>–ü–æ–¥—Å–∫–∞–∑–∫–∞</span>
                  </button>
                  <button
                    onClick={() => setShowAnswer((prev) => !prev)}
                    className="px-6 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg hover:from-purple-600 hover:to-purple-700 transition-all duration-200 flex items-center space-x-2 shadow-lg"
                  >
                    <span>üéØ</span>
                    <span>{showAnswer ? "–°–∫—Ä—ã—Ç—å –æ—Ç–≤–µ—Ç" : "–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç"}</span>
                  </button>
                </div>

                {/* –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç */}
                {showAnswer && (
                  <div className="bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-4">
                    <div className="flex items-center mb-2">
                      <span className="text-xl mr-2">üéØ</span>
                      <span className="text-purple-800 font-semibold">–†–µ—à–µ–Ω–∏–µ:</span>
                    </div>
                    <div className="bg-gradient-to-r from-gray-900 to-gray-800 rounded-xl p-6 shadow-lg">
                      <div className="flex items-center justify-between mb-4">
                        <span className="text-green-400 font-medium flex items-center">üêç Python</span>
                        <button
                          onClick={() => navigator.clipboard.writeText(currentStepData.code)}
                          className="text-gray-400 hover:text-white transition-colors flex items-center space-x-2"
                        >
                          <span>üìã</span>
                          <span>–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</span>
                        </button>
                      </div>
                      <pre className="text-green-400 overflow-x-auto text-lg">
                        <code>{currentStepData.code}</code>
                      </pre>
                    </div>
                    {currentStepData.explanation && (
                      <div className="bg-gradient-to-r from-blue-50 to-indigo-50 border-l-4 border-blue-400 p-4 rounded-xl mt-4">
                        <div className="flex items-center mb-2">
                          <span className="text-2xl mr-2">üí°</span>
                          <span className="text-blue-800 font-semibold">–û–±—ä—è—Å–Ω–µ–Ω–∏–µ</span>
                        </div>
                        <div className="text-blue-800 text-lg">
                          {currentStepData.explanation.split("\n").map((line, index) => (
                            <p key={index} className="mb-3">
                              {line}
                            </p>
                          ))}
                        </div>
                      </div>
                    )}
                  </div>
                )}

                {showHint && currentStepData.hint && (
                  <div className="bg-gradient-to-r from-blue-100 to-indigo-100 border border-blue-300 rounded-lg p-4">
                    <div className="flex items-center mb-2">
                      <span className="text-xl mr-2">üí°</span>
                      <span className="text-blue-800 font-semibold">–ü–æ–¥—Å–∫–∞–∑–∫–∞</span>
                    </div>
                    <div className="text-blue-800 text-lg">
                      {currentStepData.hint.split("\n").map((line, index) => (
                        <p key={index} className="mb-3">
                          {line}
                        </p>
                      ))}
                    </div>
                  </div>
                )}

                {/* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ */}
                {isCorrect === null && (
                  <div className="bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-4">
                    <div className="flex items-center">
                      <span className="text-xl mr-2">‚ÑπÔ∏è</span>
                      <p className="text-emerald-800 text-lg">–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ –≤ —Å–≤–æ–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –∫–æ–¥–∞, –∑–∞—Ç–µ–º –Ω–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"</p>
                    </div>
                  </div>
                )}

                {isCorrect === true && (
                  <div className="bg-gradient-to-r from-green-100 to-emerald-100 border border-green-300 rounded-lg p-4">
                    <div className="flex items-center">
                      <span className="text-xl mr-2">üéâ</span>
                      <p className="text-green-800 text-lg font-semibold">–û—Ç–ª–∏—á–Ω–æ! –í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É.</p>
                    </div>
                  </div>
                )}
              </div>
            </div>
          )}

          {/* –¢–µ—Å—Ç */}
          {currentStepData.type === "quiz" && (
            <div className="bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-6 shadow-lg">
              <h3 className="text-xl font-semibold text-purple-800 mb-4 flex items-center">
                <span className="text-2xl mr-2">üß†</span>
                –í–æ–ø—Ä–æ—Å
              </h3>
              <p className="text-purple-700 mb-6 text-lg">{currentStepData.question}</p>

              <div className="space-y-3">
                {currentStepData.options.map((option, index) => (
                  <label key={index} className="flex items-center space-x-3 cursor-pointer p-3 rounded-lg hover:bg-purple-100 transition-colors">
                    <input
                      type="radio"
                      name="quiz"
                      value={index}
                      checked={userAnswer === index.toString()}
                      onChange={handleQuizAnswerChange}
                      className="text-purple-600 focus:ring-purple-500"
                    />
                    <span className="text-purple-700 text-lg">{option}</span>
                  </label>
                ))}
              </div>

              <div className="flex space-x-4 mt-4">
                <button
                  onClick={() => {
                    console.log('=== –ö–ù–û–ü–ö–ê "–ü–†–û–í–ï–†–ò–¢–¨ –û–¢–í–ï–¢" –ù–ê–ñ–ê–¢–ê ===');
                    console.log("userAnswer –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º:", userAnswer);
                    console.log("typeof userAnswer:", typeof userAnswer);
                    console.log("disabled:", !userAnswer);
                    handleAnswerSubmit();
                  }}
                  disabled={!userAnswer}
                  className={`px-6 py-3 rounded-lg transition-all duration-200 flex items-center space-x-2 shadow-lg ${
                    userAnswer
                      ? "bg-gradient-to-r from-purple-500 to-purple-600 text-white hover:from-purple-600 hover:to-purple-700"
                      : "bg-gray-300 text-gray-500 cursor-not-allowed"
                  }`}
                >
                  <span>‚úÖ</span>
                  <span>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç</span>
                </button>
                <button
                  onClick={toggleHint}
                  className="px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-200 flex items-center space-x-2 shadow-lg"
                >
                  <span>üí°</span>
                  <span>–ü–æ–¥—Å–∫–∞–∑–∫–∞</span>
                </button>
              </div>

              {showHint && currentStepData.hint && (
                <div className="bg-gradient-to-r from-blue-100 to-indigo-100 border border-blue-300 rounded-lg p-4 mt-4">
                  <div className="flex items-center mb-2">
                    <span className="text-xl mr-2">üí°</span>
                    <span className="text-blue-800 font-semibold">–ü–æ–¥—Å–∫–∞–∑–∫–∞</span>
                  </div>
                  <div className="text-blue-800 text-lg">
                    {currentStepData.hint.split("\n").map((line, index) => (
                      <p key={index} className="mb-3">
                        {line}
                      </p>
                    ))}
                  </div>
                </div>
              )}

              {isCorrect !== null && (
                <div
                  className={`mt-4 p-4 rounded-lg ${
                    isCorrect
                      ? "bg-gradient-to-r from-green-100 to-emerald-100 border border-green-300"
                      : "bg-gradient-to-r from-red-100 to-pink-100 border border-red-300"
                  }`}
                >
                  <p className={`text-lg font-semibold ${isCorrect ? "text-green-800" : "text-red-800"}`}>
                    {isCorrect
                      ? "üéâ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! input() –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–ª —á–∏—Å–ª–æ. –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É."
                      : "‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑."}
                  </p>
                </div>
              )}

              {/* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å */}
              {currentStepData.type === "quiz" && isCorrect === null && (
                <div className="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4 mt-4">
                  <div className="flex items-center">
                    <span className="text-xl mr-2">‚ÑπÔ∏è</span>
                    <p className="text-blue-800 text-lg">
                      {userAnswer ? "–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É" : "–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å –≤—ã—à–µ"}
                    </p>
                  </div>
                </div>
              )}
            </div>
          )}
        </motion.div>
      </div>

      {/* –ù–∞–≤–∏–≥–∞—Ü–∏—è */}
      <div className="flex justify-between items-center">
        <button
          onClick={handlePrevious}
          disabled={currentStep === 0}
          className={`px-6 py-3 rounded-lg transition-all duration-200 flex items-center space-x-2 ${
            currentStep === 0
              ? "bg-gray-300 text-gray-500 cursor-not-allowed"
              : "bg-gradient-to-r from-gray-600 to-gray-700 text-white hover:from-gray-700 hover:to-gray-800 shadow-lg"
          }`}
        >
          <span>‚Üê</span>
          <span>–ù–∞–∑–∞–¥</span>
        </button>

        <div className="flex space-x-4">
          <Link
            to="/python-course"
            className="px-6 py-3 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-lg hover:from-gray-600 hover:to-gray-700 transition-all duration-200 flex items-center space-x-2 shadow-lg"
          >
            <span>üìö</span>
            <span>–ö Python –∫—É—Ä—Å—É</span>
          </Link>

          {lessonCompleted ? (
            <div className="px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg flex items-center space-x-2 shadow-lg animate-pulse">
              <span>üéâ</span>
              <span>–£—Ä–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ...</span>
            </div>
          ) : isLessonPassed ? (
            <button
              onClick={() => {
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å —É—Ä–æ–∫–∞ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
                clearLessonProgress();
                setLessonCompleted(false);
                setShowCongratulations(false);
                setIsLessonPassed(false);
                updateCurrentStep(0, steps.length);
                setUserAnswer("");
                setIsCorrect(null);
                setShowHint(false);

                // –£–¥–∞–ª—è–µ–º —É—Ä–æ–∫ –∏–∑ localStorage –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞
                try {
                  const completedLessons = JSON.parse(localStorage.getItem("completedLessons") || "[]");
                  const updatedLessons = completedLessons.filter((id) => id !== 2);
                  localStorage.setItem("completedLessons", JSON.stringify(updatedLessons));
                  console.log("–£—Ä–æ–∫ —É–¥–∞–ª–µ–Ω –∏–∑ localStorage –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è");
                } catch (error) {
                  console.error("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —É—Ä–æ–∫–∞ –∏–∑ localStorage:", error);
                }
              }}
              className="px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-200 flex items-center space-x-2 shadow-lg"
            >
              <span>üîÑ</span>
              <span>–ü–æ–≤—Ç–æ—Ä–∏—Ç—å —É—Ä–æ–∫</span>
            </button>
          ) : currentStep === steps.length - 1 && isCorrect === true ? (
            <button
              onClick={handleLessonCompletion}
              className="px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 transition-all duration-200 flex items-center space-x-2 shadow-lg"
            >
              <span>üéâ</span>
              <span>–ó–∞–≤–µ—Ä—à–∏—Ç—å —É—Ä–æ–∫</span>
            </button>
          ) : currentStep === steps.length - 1 ? (
            <div className="px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg flex items-center space-x-2 shadow-lg">
              <span>üéØ</span>
              <span>–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å –≤—ã—à–µ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Ä–æ–∫–∞</span>
            </div>
          ) : (
            <button
              onClick={handleNext}
              disabled={(() => {
                const currentStepData = steps[currentStep];
                if (currentStepData.type === "practice" || currentStepData.type === "quiz" || currentStepData.type === "theory_practice") {
                  // –ï—Å–ª–∏ —É—Ä–æ–∫ —É–∂–µ –±—ã–ª –ø—Ä–æ–π–¥–µ–Ω, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
                  return isCorrect !== true && !isLessonPassed;
                } else if (currentStepData.type === "additional_practice") {
                  // –î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ 5 –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
                  const completedTasks = currentStepData.tasks.filter((_, index) => 
                    additionalTaskAnswers[`${index}_correct`] === true
                  );
                  return completedTasks.length < 5;
                }
                return false;
              })()}
              className={`px-6 py-3 rounded-lg transition-all duration-200 flex items-center space-x-2 ${(() => {
                const currentStepData = steps[currentStep];
                if (currentStepData.type === "practice" || currentStepData.type === "quiz" || currentStepData.type === "theory_practice") {
                  return isCorrect !== true && !isLessonPassed
                    ? "bg-gray-300 text-gray-500 cursor-not-allowed"
                    : "bg-gradient-to-r from-green-500 to-green-600 text-white hover:from-green-600 hover:to-green-700 shadow-lg";
                } else if (currentStepData.type === "additional_practice") {
                  const completedTasks = currentStepData.tasks.filter((_, index) => 
                    additionalTaskAnswers[`${index}_correct`] === true
                  );
                  return completedTasks.length < 5
                    ? "bg-gray-300 text-gray-500 cursor-not-allowed"
                    : "bg-gradient-to-r from-green-500 to-green-600 text-white hover:from-green-600 hover:to-green-700 shadow-lg";
                }
                return "bg-gradient-to-r from-green-500 to-green-600 text-white hover:from-green-600 hover:to-green-700 shadow-lg";
              })()}`}
            >
              <span>–î–∞–ª–µ–µ</span>
              <span>‚Üí</span>
            </button>
          )}
        </div>
      </div>

      {/* –ú–æ—Ç–∏–≤–∞—Ü–∏—è */}
      {currentStepData.motivation && (
        <div className="bg-gradient-to-r from-yellow-50 to-orange-50 border-l-4 border-yellow-400 p-4 rounded-xl mt-8">
          <div className="flex items-center mb-2">
            <span className="text-xl mr-2">üí™</span>
            <span className="text-yellow-800 font-semibold">–ú–æ—Ç–∏–≤–∞—Ü–∏—è:</span>
          </div>
          <div className="text-yellow-800 text-lg">{currentStepData.motivation}</div>
        </div>
      )}
    </motion.div>
  );
}

export default Level1Unit4;
